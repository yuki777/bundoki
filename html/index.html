<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>ゴキゲン分度器</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <style type="text/css">
      img {border-width: 0}
      * {font-family:'Lucida Grande', sans-serif;}
    </style>

    <!-- google chart -->
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {

        // percent
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Type');
        data.addColumn('number', 'Percent');
        data.addRows(3);
        data.setValue(0, 0, 'Positive');
        data.setValue(0, 1, <?php echo $point['percent_positive']?>);
        data.setValue(1, 0, 'Negative');
        data.setValue(1, 1, <?php echo $point['percent_negative']?>);
        data.setValue(2, 0, 'Unknown');
        data.setValue(2, 1, <?php echo $point['percent_unknown']?>);
        var chart = new google.visualization.PieChart(document.getElementById('percent_chart'));
        chart.draw(data, {width: 450, height: 300, title: 'by percent'});

        // count
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Point');
        data.addColumn('number', 'Positive');
        data.addColumn('number', 'Negative');
        data.addColumn('number', 'Unknown');
        data.addRows(1);
        data.setValue(0, 0, '');
        data.setValue(0, 1, <?php echo $point['total_positive'] ?>);
        data.setValue(0, 2, <?php echo $point['total_negative'] ?>);
        data.setValue(0, 3, <?php echo $point['total_unknown'] ?>);
        var chart = new google.visualization.ColumnChart(document.getElementById('point_chart'));
        chart.draw(data, {width: 450, height: 300, title: 'by point' });
      }
    </script>
    <!-- /google chart -->

  </head>
  <body>
    <div>
      <h2>ゴキゲン分度器</h2>

      <p>あなたのツイートからゴキゲン度合いを分析して表示します</p>
      <p>(いま作ってるからもうちょっとまってくれヨ)</p>

      <p><?php echo $message; ?></p>
      <p><a target="_brank" href="https://twitter.com/intent/tweet?text=+<?php echo urlencode($message); ?>++">結果をTwitterでつぶやこう</a></p>

      <div id="percent_chart"></div>
      <div id="point_chart"></div>

      <hr />
    </div>

    <?php
    foreach($emotion_list as $emotion){
        // text
        $text = $emotion['text'];
        $text = trim($text);
        if(! $text) continue;

        // font color
        $color = "";
        if($emotion['positive_or_negative'] == 'positive') $color = "green";
        if($emotion['positive_or_negative'] == 'negative') $color = "red";

        // print
        echo "<li>";
        echo "[".$emotion['positive_or_negative']."]";
        echo '<font color="'.$color.'">';
        echo $text;
        echo "</font>";
        echo "</li>";
    }
    ?>
    <hr>(c) gokibun.com

  </body>
</html>
